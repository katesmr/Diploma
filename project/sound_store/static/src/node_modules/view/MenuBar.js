var inherit = require("../utils/inherit");
var BaseView = require("./BaseView");
var UserInfoBar = require("./UserInfoBar");
var TrackView = require("./TrackView");
var TrackListView = require("./TrackListView");
var ProjectListView = require("./ProjectListView");
var PlayerView = require("./PlayerView");
var Factory = require("./Factory");
var commonEventNames = require("../core/commonEventNames");
var windowsTransport = require("./windowsTransport");

module.exports = MenuBar;

function MenuBar(){
    BaseView.call(this, "menubar");

    this.userInfoBar = new UserInfoBar();
    this.backButton = Factory.createIconButton("ui button user-only", "arrow left icon", "");
    this.player = new PlayerView();

    this._build();
}

inherit(MenuBar, BaseView);

MenuBar.prototype._build = function(){
    var container = this.getContainer();

    //windowsTransport.notify(commonEventNames.E_DEFINE_USER);

    this.backButton.on("click", function(event){
        // Possible additional visual effect for this button...
        windowsTransport.notify(commonEventNames.ON_BACK_BUTTON_CLICK);
    });

    container.append(this.backButton);
    container.append(this.player.getContainer());
    container.append(this.userInfoBar.getContainer());
};

MenuBar.prototype.adaptToActiveWindow = function(newWindow){
    if(newWindow instanceof TrackView || newWindow instanceof TrackListView){
        this.backButton.show();
        this.player.show();
        this.player.audioPlayer.setModel(newWindow.controller.model);
    } else if(newWindow instanceof ProjectListView){
        this.backButton.hide();
        this.player.hide();
    }
    // Here you can get some public properties from the window to update the "look" of the menu bar
    // For example:
    // - window.title
    // - change some controlls according to the window type
};
