var inherit = require("../utils/inherit");
var Factory = require("./Factory");
var BaseView = require("./BaseView");
var RequestManager = require("../utils/RequestManager");
var eventListener = require("../model/eventListener");

module.exports = WaveForm;

function WaveForm(){
    BaseView.call(this, "waveform");

    //$(this.getContainer()).attr("id", "waveform");
    //this.waveContainer = $("<div id='waveform'></div>");

    this.waveform = null;

    this._build();
}

inherit(WaveForm, BaseView);

WaveForm.prototype._build = function(){
    //this.getContainer().append(this.waveContainer);
};

WaveForm.prototype.test = function(){
    RequestManager.uploadSound("test.wav", this.createWaveFormFromFile.bind(this));
};

WaveForm.prototype.createWaveFormFromFile = function(blob){
    this.waveform = WaveSurfer.create({
        container: "#waveform",
        waveColor: "#626262",
        progressColor: "#fff843"
    });
    this.waveform.loadBlob(blob);
};

WaveForm.prototype.createWaveForm = function(audioContext){
    var self = this;
    console.log(this.getContainer());
    this.waveform = WaveSurfer.create({
        container: self.getContainer(),
        audioContext: audioContext,
        waveColor: "#626262",
        progressColor: "#fff843"
    });
    console.log(this.waveform);
};
