// var getProjectData = require("requests/getProjectData");
var transportAudioFile = require("./utils/transportAudioFile");
var TrackManager = require("./utils/TrackManager");

var changeSound = require("./requests/changeSound");
var getSound = require("./requests/getSound");
var projectList = require("./requests/projectList");
var deleteProject = require("./requests/deleteProject");
var getUser = require("./requests/getUser");

var MessageModal = require("./view/MessageModal");

module.exports = RequestManager;

function RequestManager(){
    this.messageModal = new MessageModal();
}

RequestManager.getUser = function(callback, context){
    getUser(callback.bind(context));
    /*getUser(function(){
        //projectList("projects/", projectView.fullProjectList.bind(projectView));
        projectList("projects/", callback.bind(context));
    });*/
};

RequestManager.getProjectData = function(){};

RequestManager.deleteProject = function(projectName){
    var url = "projects/delete/";
    var fullUrl = url + projectName + '/';
    deleteProject(fullUrl, this.messageModal.show);
};

RequestManager.prototype.getProject = function(){};

RequestManager.prototype.createSound = function(soundName, audioSrc){
    var url = "sound/create/";
    // var url = "sound/update/";
    var fullUrl = url + soundName + '/';
    transportAudioFile(fullUrl, soundName, audioSrc, changeSound);
};

RequestManager.prototype.downloadSound = function(soundName){
    var url = "sound/download/";
    var fullUrl = url + soundName + '/';
    getSound(fullUrl, function(data){
        TrackManager.save(data, soundName);
    });
};

RequestManager.prototype.uploadSound = function(soundName){
    var url = "sound/download/";
    var fullUrl = url + soundName + '/';
    getSound(fullUrl, function(data){
        // play sound
    });
};
