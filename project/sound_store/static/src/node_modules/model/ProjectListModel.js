var RequestManager = require("../utils/RequestManager");
var eventListener = require("./eventListener");

module.exports = ProjectListModel;

function ProjectListModel(){
    this.projectNameList = [];
    eventListener.subscribe(eventListener.ON_DELETE_PROJECT, this.deleteProject.bind(this));
}

ProjectListModel.prototype.fetchData = function(){
    var self = this;
    this.projectNameList.length = 0;
    RequestManager.getProjectList(function(data){
        if (data instanceof Error){
            // Smth bad is happening!!
        } else{
            self.projectNameList = data; // disappear after request end !!
            eventListener.notify(eventListener.PROJECT_LIST_MODEL_UPDATED, self);
        }
    });
};

ProjectListModel.prototype.deleteProject = function(eventName, projectName){
    RequestManager.deleteProject(projectName);
    eventListener.notify(eventListener.ON_SHOW_PROJECT_LIST);
};

ProjectListModel.prototype.addNewProject = function(eventName, object){
    // create
    eventListener.notify(eventListener.ON_SHOW_PROJECT_LIST);
};
