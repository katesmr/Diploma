var PianoNote = require("./PianoNote");

module.exports = new PianoModel;

function PianoModel(){
    this.notes = [
        new PianoNote("C2", [], "C2"),
        new PianoNote("C2#", [], "C2#"),
        new PianoNote("D2", [], "D2"),
        new PianoNote("D2#", [], "D2#"),
        new PianoNote("E2", [], "E2"),
        new PianoNote("F2", [], "F2"),
        new PianoNote("F2#", [], "F2#"),
        new PianoNote("G2", [], "G2"),
        new PianoNote("G2#", [], "G2#"),
        new PianoNote("A2", [], "A2"),
        new PianoNote("A2#", [], "A2#"),
        new PianoNote("B2", [], "B2"),
        new PianoNote("C3", [], "E3"),
        new PianoNote("C3#", [], "C3#"),
        new PianoNote("D3", [], "D3"),
        new PianoNote("D3#", [], "D3#"),
        new PianoNote("E3", [], "E3"),
        new PianoNote("F3", [], "F3"),
        new PianoNote("F3#", [], "F3#"),
        new PianoNote("G3", [], "G3"),
        new PianoNote("G3#", [], "G3#"),
        new PianoNote("A3", [], "A3"),
        new PianoNote("A3#", [], "A3#"),
        new PianoNote("B3", [], "B3"),
        new PianoNote("C4", [], "C4"),
        new PianoNote("C4#", [], "C4#"),
        new PianoNote("D4", [], "D4"),
        new PianoNote("D4#", [], "D4#"),
        new PianoNote("E4", [], "E4"),
        new PianoNote("F4", [], "F4"),
        new PianoNote("F4#", [], "F4#"),
        new PianoNote("G4", [], "G4"),
        new PianoNote("G4#", [], "G4#"),
        new PianoNote("A4", [], "A4"),
        new PianoNote("A4#", [], "A4#"),
        new PianoNote("B4", [], "B4")
    ];
}

PianoModel.prototype.getNoteForKey = function(keyCode){
    var result = null;
    switch(String.fromCharCode(keyCode)){
        case '0': result = this.__findNoteByValue("C2#"); break;
        case '2': result = this.__findNoteByValue("D2#"); break;
        case '4': result = this.__findNoteByValue("F2#"); break;
        case '6': result = this.__findNoteByValue("G2#"); break;
        case '8': result = this.__findNoteByValue("A2#"); break;
        case 'Q': result = this.__findNoteByValue("C3#"); break;
        case 'W': result = this.__findNoteByValue("D3#"); break;
        case 'E': result = this.__findNoteByValue("F3#"); break;
        case 'R': result = this.__findNoteByValue("G3#"); break;
        case 'T': result = this.__findNoteByValue("A3#"); break;
        case 'Y': result = this.__findNoteByValue("C4#"); break;
        case 'U': result = this.__findNoteByValue("D4#"); break;
        case 'I': result = this.__findNoteByValue("F4#"); break;
        case 'O': result = this.__findNoteByValue("G4#"); break;
        case 'P': result = this.__findNoteByValue("A4#"); break;
        case 'A': result = this.__findNoteByValue("C2"); break;
        case 'S': result = this.__findNoteByValue("D2"); break;
        case 'D': result = this.__findNoteByValue("E2"); break;
        case 'F': result = this.__findNoteByValue("F2"); break;
        case 'G': result = this.__findNoteByValue("G2"); break;
        case 'H': result = this.__findNoteByValue("A2"); break;
        case 'J': result = this.__findNoteByValue("B2"); break;
        case 'K': result = this.__findNoteByValue("E3"); break;
        case 'L': result = this.__findNoteByValue("D3"); break;
        case ';': result = this.__findNoteByValue("E3"); break;
        case "'": result = this.__findNoteByValue("F3"); break;
        case 'Z': result = this.__findNoteByValue("G3"); break;
        case 'X': result = this.__findNoteByValue("A3"); break;
        case 'C': result = this.__findNoteByValue("B3"); break;
        case 'V': result = this.__findNoteByValue("C4"); break;
        case 'B': result = this.__findNoteByValue("D4"); break;
        case 'N': result = this.__findNoteByValue("E4"); break;
        case 'M': result = this.__findNoteByValue("F4"); break;
        case ',': result = this.__findNoteByValue("G4"); break;
        case '.': result = this.__findNoteByValue("A4"); break;
        case '/': result = this.__findNoteByValue("B4"); break;
        default: console.log("wrong key code: " + keyCode); break;
    }
    return result;
};

PianoModel.prototype.__findNoteByValue = function(value){
    var i;
    for (i = 0; i < this.notes.length; ++i){
        if (this.notes[i].value === value){
            return this.notes[i];
        }
    }
    return null;
};

PianoModel.prototype.shift = function(shiftIndex){
    var i;
    for(i = 0; i < this.notes.length; ++i){
        this.notes[i].setValueFromAdditional(shiftIndex);
    }
};

PianoModel.prototype.keyList = function(){
    return ['A', '0', 'S', '2', 'D', 'F', '4', 'G', '6', 'H', '8', 'J', 'K', 'Q', 'L', 'W', ';', "'",
            'E', 'Z', 'R', 'X', 'T', 'C', 'V', 'Y', 'B', 'U', 'N', 'M', 'I', ',', 'O', '.', 'P', '/']
};
