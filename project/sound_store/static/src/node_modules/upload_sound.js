module.exports = function(){
	$.ajax({
		method: "GET",
		url: "sounds/test.wav/",
		dataType: "binary",
		cache: false,
		processData: false,
		success: function(data){
			playSound(data);
		},
		error: function(status){
			console.error(status);
		}
	});
};

function playSound(blobObject){
    console.log(blobObject);
	var audioData;
	var context = new AudioContext(); // Create and Initialize the Audio Context
    var reader = new FileReader();
    // event handler executed when the load readAsArrayBuffer
    reader.onload = function() {
       // reader.result contains the contents of blob as a typed array
        var arrayBuffer = reader.result;
        context.decodeAudioData(arrayBuffer, function(buffer) {
            audioData = buffer;
        });

        window.addEventListener("keydown",onKeyDown); // Create Event Listener for KeyDown
        function onKeyDown(e){
            switch (e.keyCode) {
                // X
                case 88:
                    console.log("+");
                    var playSound = context.createBufferSource(); // Declare a New Sound
                    playSound.buffer = audioData; // Attatch our Audio Data as it's Buffer
                    playSound.connect(context.destination);  // Link the Sound to the Output
                    playSound.start(0); // Play the Sound Immediately
                break;
            }
        }
    };
    // convert blob to ArrayBuffer for playing on page
    reader.readAsArrayBuffer(blobObject);
}
