module.exports = function(){
    $.ajax({
		method: "GET",
		url: "sounds/test.wav/",
		dataType: "binary",  // blob????
		cache: false,
		processData: false,
		success: function(data){
		    console.log(data);
			playSound(data);
		},
		error: function(status){
			console.error(status);
		}
	});
};

function playSound(blobObject){
    var audioData;
	//var arrayBuffer;
    var reader = new FileReader();
    var context = new AudioContext();
    reader.onload = function(){
        var arrayBuffer = reader.result;
        console.log(arrayBuffer);
        context.decodeAudioData(arrayBuffer, function(buffer){
            audioData = buffer;
            console.log(audioData);
            var freeverb = new Tone.Freeverb().toMaster();
            freeverb.dampening.value = 1000;
            var player = new Tone.Player(audioData).toMaster();
            //routing synth through the reverb
            player.connect(freeverb);
            player.start();
            var context = player.context;
            // https://developer.mozilla.org/en-US/docs/Web/API/OscillatorNode
            // get audio data for change audio with Tone
            var oscillator = context.createOscillator();
            console.log(oscillator);
        });
    };
    reader.readAsArrayBuffer(blobObject);
}
